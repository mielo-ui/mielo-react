@use "sass:list";
@use "sass:map";
@use "sass:meta";

@mixin variants-expand-variables($class, $variants) {
  $list: map-flatten($variants);
  $name: _kebab-case($class);

  @each $item in $list {
    $key: _join(_get($item, 1), "-");
    
    $property: --adw-#{$name}-#{$key};
    $value: _get($item, 2);

    #{$property}: #{$value};
  }
}

@mixin variants-assign-to-component($class, $variants, $default-variant: "default") {
  $name: _kebab-case($class);

  @each $variant in _keys($variants) {
    $class-ext: if($variant != $default-variant, "." + $variant, "");
    $vars: map-flatten-keys(_get($variants, $variant));

    .adw.#{$class}#{$class-ext} {
      @each $keys in $vars {
        $key: _join($keys, "-");
        
        $value: var(--adw-#{$name}-#{$variant}-#{$key});
        $property: --adw-#{$name}-#{$key};

        #{$property}: #{$value};
      }
    }
  }
}

@mixin variants-map-to-component($component, $variants, $default-name: "default") {
  :root,
  [data-theme="light"],
  [data-theme="dark"] {
    @include variants-expand-variables($component, $variants);
  }

  @include variants-assign-to-component($component, $variants, $default-name);
}
